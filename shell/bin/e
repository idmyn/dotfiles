#!/usr/bin/env sh

EMACS=${EMACS:-emacs}
EMACSCLIENT=${EMACSCLIENT:-emacsclient}

if [ "$(ps -ax | rg -c -i emacs)" -gt 1 ]; then
    if [ "$($EMACSCLIENT -e '(length (frame-list))')" -gt 1 ]; then
        osascript -e 'tell application "emacs" to activate first window'
        $EMACSCLIENT -n "$1"
    else
        $EMACSCLIENT -nc "$1"
        osascript -e 'tell application "emacs" to activate first window'
    fi
else
    $EMACS --daemon; $EMACSCLIENT -nc "$1"
fi
